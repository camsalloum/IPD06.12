[2025-12-04 17:55:31] [INFO] ========================================================================
[2025-12-04 17:55:32] [INFO] AEBF Excel to SQL Transform & Upload Script
[2025-12-04 17:55:32] [INFO] ========================================================================
[2025-12-04 17:55:32] [INFO] Excel File: D:\Projects\IPD26.10\uploads\aebf-upload-1764856529578.xlsx
[2025-12-04 17:55:32] [INFO] Division: FP
[2025-12-04 17:55:32] [INFO] Upload Mode: replace
[2025-12-04 17:55:32] [INFO] Uploaded By: cam
[2025-12-04 17:55:32] [INFO] Test Mode: False
[2025-12-04 17:55:32] [INFO] ========================================================================
[2025-12-04 17:55:32] [INFO] Checking prerequisites...
[2025-12-04 17:55:32] [SUCCESS] Prerequisites check passed
[2025-12-04 17:55:32] [INFO] Testing database connection...
[2025-12-04 17:55:32] [SUCCESS] Database connection successful
[2025-12-04 17:55:33] [INFO] PostgreSQL version: PostgreSQL 17.5 on x86_64-windows, compiled by msvc-19.44.35209, 64-bit 
[2025-12-04 17:55:33] [INFO] Reading Excel file (first sheet)...
[2025-12-04 17:57:18] [INFO] Excel has 23985 total rows
[2025-12-04 17:57:19] [SUCCESS] Read 23985 rows from Excel (filtered to 23985 valid rows)
[2025-12-04 17:57:19] [INFO] Upload type: Actual (separate file upload, not combined with Budget)
[2025-12-04 17:57:19] [INFO] Validating Excel structure...
[2025-12-04 17:57:19] [SUCCESS] Excel structure validation passed
[2025-12-04 17:57:19] [INFO] Total rows: 23985
[2025-12-04 17:57:19] [INFO] Transforming Excel data to SQL format...
[2025-12-04 17:57:19] [INFO] Applying data normalization: TRIM + Proper Case conversion
[2025-12-04 17:59:27] [SUCCESS] Transformed 23985 rows with normalization applied
[2025-12-04 17:59:27] [INFO] Generating QC summary...
[2025-12-04 17:59:34] [INFO] QC Summary:
[2025-12-04 17:59:34] [INFO]   Total Records: 23985
[2025-12-04 17:59:34] [INFO]   Years: 2020, 2021, 2022, 2023, 2024, 2025
[2025-12-04 17:59:34] [INFO]   Months: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12
[2025-12-04 17:59:34] [INFO]   Values Types: AMOUNT, KGS, MORM
[2025-12-04 17:59:34] [INFO]   Total AMOUNT: 558133754.75
[2025-12-04 17:59:34] [INFO]   Total KGS: 49798587.76
[2025-12-04 17:59:34] [INFO]   Total MORM: 211695665.655026
[2025-12-04 17:59:34] [INFO] Creating backup before REPLACE operation...
[2025-12-04 17:59:34] [INFO] REPLACE mode will delete ALL existing data for division FP, type Actual
[2025-12-04 17:59:40] [SUCCESS] Backup created: 23985  records backed up (ALL existing FP Actual data)
[2025-12-04 17:59:40] [INFO] Deleting ALL existing data for REPLACE mode...
[2025-12-04 17:59:40] [INFO] WARNING: This will delete ALL FP Actual data, not just overlapping months
[2025-12-04 17:59:41] [INFO] Records before delete: 23985 
[2025-12-04 17:59:43] [SUCCESS] Records deleted: 23985 
[2025-12-04 17:59:43] [SUCCESS] Records remaining: 0 
[2025-12-04 17:59:43] [INFO] Uploading data in INSERT mode (batch size: 1000)...
[2025-12-04 17:59:43] [INFO] Processing batch 1 of 24 (1000 rows)...
[2025-12-04 17:59:45] [SUCCESS] Batch 1 completed successfully
[2025-12-04 17:59:45] [INFO] Processing batch 2 of 24 (1000 rows)...
[2025-12-04 17:59:46] [SUCCESS] Batch 2 completed successfully
[2025-12-04 17:59:46] [INFO] Processing batch 3 of 24 (1000 rows)...
[2025-12-04 17:59:47] [SUCCESS] Batch 3 completed successfully
[2025-12-04 17:59:47] [INFO] Processing batch 4 of 24 (1000 rows)...
[2025-12-04 17:59:49] [SUCCESS] Batch 4 completed successfully
[2025-12-04 17:59:49] [INFO] Processing batch 5 of 24 (1000 rows)...
[2025-12-04 17:59:50] [SUCCESS] Batch 5 completed successfully
[2025-12-04 17:59:50] [INFO] Processing batch 6 of 24 (1000 rows)...
[2025-12-04 17:59:51] [SUCCESS] Batch 6 completed successfully
[2025-12-04 17:59:51] [INFO] Processing batch 7 of 24 (1000 rows)...
[2025-12-04 17:59:52] [SUCCESS] Batch 7 completed successfully
[2025-12-04 17:59:52] [INFO] Processing batch 8 of 24 (1000 rows)...
[2025-12-04 17:59:53] [SUCCESS] Batch 8 completed successfully
[2025-12-04 17:59:53] [INFO] Processing batch 9 of 24 (1000 rows)...
[2025-12-04 17:59:54] [SUCCESS] Batch 9 completed successfully
[2025-12-04 17:59:54] [INFO] Processing batch 10 of 24 (1000 rows)...
[2025-12-04 17:59:55] [SUCCESS] Batch 10 completed successfully
[2025-12-04 17:59:55] [INFO] Processing batch 11 of 24 (1000 rows)...
[2025-12-04 17:59:56] [SUCCESS] Batch 11 completed successfully
[2025-12-04 17:59:56] [INFO] Processing batch 12 of 24 (1000 rows)...
[2025-12-04 17:59:57] [SUCCESS] Batch 12 completed successfully
[2025-12-04 17:59:57] [INFO] Processing batch 13 of 24 (1000 rows)...
[2025-12-04 17:59:58] [SUCCESS] Batch 13 completed successfully
[2025-12-04 17:59:58] [INFO] Processing batch 14 of 24 (1000 rows)...
[2025-12-04 17:59:59] [SUCCESS] Batch 14 completed successfully
[2025-12-04 17:59:59] [INFO] Processing batch 15 of 24 (1000 rows)...
[2025-12-04 18:00:00] [SUCCESS] Batch 15 completed successfully
[2025-12-04 18:00:00] [INFO] Processing batch 16 of 24 (1000 rows)...
[2025-12-04 18:00:01] [SUCCESS] Batch 16 completed successfully
[2025-12-04 18:00:01] [INFO] Processing batch 17 of 24 (1000 rows)...
[2025-12-04 18:00:02] [SUCCESS] Batch 17 completed successfully
[2025-12-04 18:00:02] [INFO] Processing batch 18 of 24 (1000 rows)...
[2025-12-04 18:00:03] [SUCCESS] Batch 18 completed successfully
[2025-12-04 18:00:03] [INFO] Processing batch 19 of 24 (1000 rows)...
[2025-12-04 18:00:04] [SUCCESS] Batch 19 completed successfully
[2025-12-04 18:00:04] [INFO] Processing batch 20 of 24 (1000 rows)...
[2025-12-04 18:00:05] [SUCCESS] Batch 20 completed successfully
[2025-12-04 18:00:05] [INFO] Processing batch 21 of 24 (1000 rows)...
[2025-12-04 18:00:06] [SUCCESS] Batch 21 completed successfully
[2025-12-04 18:00:06] [INFO] Processing batch 22 of 24 (1000 rows)...
[2025-12-04 18:00:07] [SUCCESS] Batch 22 completed successfully
[2025-12-04 18:00:07] [INFO] Processing batch 23 of 24 (1000 rows)...
[2025-12-04 18:00:08] [SUCCESS] Batch 23 completed successfully
[2025-12-04 18:00:08] [INFO] Processing batch 24 of 24 (985 rows)...
[2025-12-04 18:00:09] [SUCCESS] Batch 24 completed successfully
[2025-12-04 18:00:09] [SUCCESS] INSERT completed: 23985 rows processed
[2025-12-04 18:00:09] [INFO] Running post-upload QC verification...
[2025-12-04 18:00:10] [INFO] Post-upload QC Results:
[2025-12-04 18:00:10] [INFO]  AMOUNT      |         7995 | 558133754.7500  KGS         |         7995 |  49798587.7600  MORM        |         7995 | 211695665.6567 
[2025-12-04 18:00:10] [INFO] Writing audit log...
[2025-12-04 18:00:10] [SUCCESS] Audit log written successfully
[2025-12-04 18:00:10] [INFO] ========================================================================
[2025-12-04 18:00:10] [SUCCESS] Upload completed successfully!
[2025-12-04 18:00:10] [INFO] Total records processed: 23985
[2025-12-04 18:00:10] [INFO] Mode: replace
[2025-12-04 18:00:10] [INFO] Log file: logs\upload-20251204_175531.txt
[2025-12-04 18:00:10] [INFO] ========================================================================
