[2025-11-14 12:19:14] [INFO] ========================================================================
[2025-11-14 12:19:14] [INFO] AEBF Excel to SQL Transform & Upload Script
[2025-11-14 12:19:14] [INFO] ========================================================================
[2025-11-14 12:19:14] [INFO] Excel File: D:\Projects\IPD26.10\uploads\aebf-upload-1763108352677.xlsx
[2025-11-14 12:19:14] [INFO] Division: FP
[2025-11-14 12:19:14] [INFO] Upload Mode: upsert
[2025-11-14 12:19:14] [INFO] Uploaded By: Cam
[2025-11-14 12:19:14] [INFO] Test Mode: False
[2025-11-14 12:19:14] [INFO] ========================================================================
[2025-11-14 12:19:14] [INFO] Checking prerequisites...
[2025-11-14 12:19:14] [SUCCESS] Prerequisites check passed
[2025-11-14 12:19:14] [INFO] Testing database connection...
[2025-11-14 12:19:14] [SUCCESS] Database connection successful
[2025-11-14 12:19:14] [INFO] PostgreSQL version: PostgreSQL 17.5 on x86_64-windows, compiled by msvc-19.44.35209, 64-bit 
[2025-11-14 12:19:14] [INFO] Reading Excel file (first sheet)...
[2025-11-14 12:19:47] [INFO] Excel has 23841 total rows
[2025-11-14 12:19:48] [SUCCESS] Read 23841 rows from Excel (filtered to 23841 valid rows)
[2025-11-14 12:19:48] [INFO] Selective mode enabled: 2020-1,2020-2,2020-3,2020-4,2020-5,2020-6,2020-7,2020-8,2020-9,2020-10,2020-11,2020-12,2021-1,2021-2,2021-3,2021-4,2021-5,2021-6,2021-7,2021-8,2021-9,2021-10,2021-11,2021-12,2022-1,2022-2,2022-3,2022-4,2022-5,2022-6,2022-7,2022-8,2022-9,2022-10,2022-11,2022-12,2023-1,2023-2,2023-3,2023-4,2023-5,2023-6,2023-7,2023-8,2023-9,2023-10,2023-11,2023-12,2024-1,2024-2,2024-3,2024-4,2024-5,2024-6,2024-7,2024-8,2024-9,2024-10,2024-11,2024-12,2025-1,2025-2,2025-3,2025-4,2025-5,2025-6,2025-7,2025-8,2025-9,2025-10
[2025-11-14 12:20:05] [INFO] Filtered to 23709 rows (from 23841) matching selected periods
[2025-11-14 12:20:05] [INFO] Upload type: Actual (separate file upload, not combined with Budget)
[2025-11-14 12:20:05] [INFO] Validating Excel structure...
[2025-11-14 12:20:05] [SUCCESS] Excel structure validation passed
[2025-11-14 12:20:05] [INFO] Total rows: 23709
[2025-11-14 12:20:05] [INFO] Transforming Excel data to SQL format...
[2025-11-14 12:20:34] [SUCCESS] Transformed 23709 rows
[2025-11-14 12:20:34] [INFO] Generating QC summary...
[2025-11-14 12:20:37] [INFO] QC Summary:
[2025-11-14 12:20:37] [INFO]   Total Records: 23709
[2025-11-14 12:20:37] [INFO]   Years: 2020, 2021, 2022, 2023, 2024, 2025
[2025-11-14 12:20:37] [INFO]   Months: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12
[2025-11-14 12:20:37] [INFO]   Values Types: AMOUNT, KGS, MORM
[2025-11-14 12:20:37] [INFO]   Total AMOUNT: 549473534.75
[2025-11-14 12:20:37] [INFO]   Total KGS: 48998008.57
[2025-11-14 12:20:37] [INFO]   Total MORM: 208283708.862756
[2025-11-14 12:20:37] [INFO] Uploading data in UPSERT mode (batch size: 1000)...
[2025-11-14 12:20:37] [INFO] NOTE: UPSERT mode currently uses DELETE + INSERT for overlapping records
[2025-11-14 12:20:37] [INFO] TODO: Implement interactive conflict resolution in future version
[2025-11-14 12:20:37] [INFO] Processing batch 1 of 24 (1000 rows)...
[2025-11-14 12:20:38] [SUCCESS] Batch 1 completed successfully
[2025-11-14 12:20:38] [INFO] Processing batch 2 of 24 (1000 rows)...
[2025-11-14 12:20:39] [SUCCESS] Batch 2 completed successfully
[2025-11-14 12:20:39] [INFO] Processing batch 3 of 24 (1000 rows)...
[2025-11-14 12:20:40] [SUCCESS] Batch 3 completed successfully
[2025-11-14 12:20:40] [INFO] Processing batch 4 of 24 (1000 rows)...
[2025-11-14 12:20:41] [SUCCESS] Batch 4 completed successfully
[2025-11-14 12:20:41] [INFO] Processing batch 5 of 24 (1000 rows)...
[2025-11-14 12:20:42] [SUCCESS] Batch 5 completed successfully
[2025-11-14 12:20:42] [INFO] Processing batch 6 of 24 (1000 rows)...
[2025-11-14 12:20:43] [SUCCESS] Batch 6 completed successfully
[2025-11-14 12:20:43] [INFO] Processing batch 7 of 24 (1000 rows)...
[2025-11-14 12:20:43] [SUCCESS] Batch 7 completed successfully
[2025-11-14 12:20:43] [INFO] Processing batch 8 of 24 (1000 rows)...
[2025-11-14 12:20:44] [SUCCESS] Batch 8 completed successfully
[2025-11-14 12:20:44] [INFO] Processing batch 9 of 24 (1000 rows)...
[2025-11-14 12:20:45] [SUCCESS] Batch 9 completed successfully
[2025-11-14 12:20:45] [INFO] Processing batch 10 of 24 (1000 rows)...
[2025-11-14 12:20:46] [SUCCESS] Batch 10 completed successfully
[2025-11-14 12:20:46] [INFO] Processing batch 11 of 24 (1000 rows)...
[2025-11-14 12:20:47] [SUCCESS] Batch 11 completed successfully
[2025-11-14 12:20:47] [INFO] Processing batch 12 of 24 (1000 rows)...
[2025-11-14 12:20:48] [SUCCESS] Batch 12 completed successfully
[2025-11-14 12:20:48] [INFO] Processing batch 13 of 24 (1000 rows)...
[2025-11-14 12:20:49] [SUCCESS] Batch 13 completed successfully
[2025-11-14 12:20:49] [INFO] Processing batch 14 of 24 (1000 rows)...
[2025-11-14 12:20:51] [SUCCESS] Batch 14 completed successfully
[2025-11-14 12:20:51] [INFO] Processing batch 15 of 24 (1000 rows)...
[2025-11-14 12:20:51] [SUCCESS] Batch 15 completed successfully
[2025-11-14 12:20:51] [INFO] Processing batch 16 of 24 (1000 rows)...
[2025-11-14 12:20:52] [SUCCESS] Batch 16 completed successfully
[2025-11-14 12:20:52] [INFO] Processing batch 17 of 24 (1000 rows)...
[2025-11-14 12:20:53] [SUCCESS] Batch 17 completed successfully
[2025-11-14 12:20:53] [INFO] Processing batch 18 of 24 (1000 rows)...
[2025-11-14 12:20:54] [SUCCESS] Batch 18 completed successfully
[2025-11-14 12:20:54] [INFO] Processing batch 19 of 24 (1000 rows)...
[2025-11-14 12:20:55] [SUCCESS] Batch 19 completed successfully
[2025-11-14 12:20:55] [INFO] Processing batch 20 of 24 (1000 rows)...
[2025-11-14 12:20:56] [SUCCESS] Batch 20 completed successfully
[2025-11-14 12:20:56] [INFO] Processing batch 21 of 24 (1000 rows)...
[2025-11-14 12:20:57] [SUCCESS] Batch 21 completed successfully
[2025-11-14 12:20:57] [INFO] Processing batch 22 of 24 (1000 rows)...
[2025-11-14 12:20:57] [SUCCESS] Batch 22 completed successfully
[2025-11-14 12:20:57] [INFO] Processing batch 23 of 24 (1000 rows)...
[2025-11-14 12:20:58] [SUCCESS] Batch 23 completed successfully
[2025-11-14 12:20:58] [INFO] Processing batch 24 of 24 (709 rows)...
[2025-11-14 12:20:59] [SUCCESS] Batch 24 completed successfully
[2025-11-14 12:20:59] [SUCCESS] UPSERT completed: 23709 rows processed
[2025-11-14 12:20:59] [INFO] Running post-upload QC verification...
[2025-11-14 12:21:00] [INFO] Post-upload QC Results:
[2025-11-14 12:21:00] [INFO]  AMOUNT      |         7947 | 551194995.7700  KGS         |         7947 |  49153681.6200  MORM        |         7947 | 209047484.7457 
[2025-11-14 12:21:00] [INFO] Writing audit log...
[2025-11-14 12:21:00] [SUCCESS] Audit log written successfully
[2025-11-14 12:21:00] [INFO] ========================================================================
[2025-11-14 12:21:00] [SUCCESS] Upload completed successfully!
[2025-11-14 12:21:00] [INFO] Total records processed: 23709
[2025-11-14 12:21:00] [INFO] Mode: upsert
[2025-11-14 12:21:00] [INFO] Log file: logs\upload-20251114_121914.txt
[2025-11-14 12:21:00] [INFO] ========================================================================
